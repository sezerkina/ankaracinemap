<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ankara Sineması Haritası</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<style>
html,body{height:100%;margin:0;font-family:Arial, sans-serif;}
#map{position:absolute;left:0;top:0;right:0;bottom:0;}
</style>
</head>
<body>
<div id="map"></div>
<script>
const map = L.map('map').setView([39.93,32.85],11);
L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
  attribution:'&copy; OpenStreetMap contributors &copy; Carto'
}).addTo(map);

fetch('kmzs.geojson')
.then(r=>r.json())
.then(data=>{
  L.geoJSON(data, {
    pointToLayer: (feature, latlng) => {
      const p = feature.properties || {};
      const iconHref = p.icon?.href;
      if(iconHref){
        return L.marker(latlng, {
          icon: L.icon({
            iconUrl: iconHref,
            iconSize: [32, 32],
            iconAnchor: [16, 32]
          })
        });
      } else {
        const color = p.style?.color || p.stroke || p.fill || (p.styleUrl?.match(/#[0-9A-Fa-f]{6}/)?.[0]) || '#2563eb';
        const fillOpacity = p['fill-opacity'] ?? p.opacity ?? 0.9;
        return L.circleMarker(latlng, {
          radius: 6,
          color,
          fillColor: color,
          fillOpacity
        });
      }
    },
    style: (feature) => {
      const p = feature.properties || {};
      const color = p.style?.color || p.stroke || p.fill || (p.styleUrl?.match(/#[0-9A-Fa-f]{6}/)?.[0]) || '#ff5252';
      return {
        color,
        weight: p.style?.width || p['stroke-width'] || 2,
        opacity: p.style?.opacity ?? p.opacity ?? 0.9
      };
    },
    onEachFeature: (feature, layer) => {
      const p = feature.properties || {};
      let popup = `<b>${p.name || '(Adsız Mekân)'}</b>`;
      if(p.description) popup += `<br>${p.description}`;
      layer.bindPopup(popup);
    }
  }).addTo(map);
});
</script>
</body>
</html>